\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={DATA 605 - Assignment 4},
            pdfauthor={Joshua Sturm},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}
  \title{DATA 605 - Assignment 4}
  \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
  \author{Joshua Sturm}
  \preauthor{\centering\large\emph}
  \postauthor{\par}
  \predate{\centering\large\emph}
  \postdate{\par}
  \date{02/24/2018}


\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(pracma)}
\end{Highlighting}
\end{Shaded}

\section{Problem Set 1}\label{problem-set-1}

\subsection{1. In this problem, we'll verify using R that SVD and
Eigenvalues are related as worked out in the weekly
module.}\label{in-this-problem-well-verify-using-r-that-svd-and-eigenvalues-are-related-as-worked-out-in-the-weekly-module.}

Given a 3 Ã— 2 matrix \(A\):
\(\begin{bmatrix}1 & 2 & 3\\ -1 & 0 & 4\end{bmatrix}\) write code in R
to compute \(X = AA^T\) and \(Y = A^TA\). Then, compute the eigenvalues
and eigenvectors of \(X\) and \(Y\) using the built-in commands in
R.\textbackslash{} Then, compute the left-singular, singular values, and
right-singular vectors of \(A\) using the \texttt{svd} command. Examine
the two sets of singular vectors and show that they are indeed
eigenvectors of \(X\) and \(Y\). In addition, the two non-zero
eigenvalues (the 3rd value will be very close to zero, if not zero) of
both \(X\) and \(Y\) are the same and are squares of the non-zero
singular of \(A\).

Your code should compute all these vectors and scalars and store them in
variables. Please add enough comments in your code to show me how to
interpret your steps.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Input matrix A}
\NormalTok{A <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}
              \OperatorTok{-}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{4}\NormalTok{),}
            \DataTypeTok{nrow=}\DecValTok{2}\NormalTok{, }\DataTypeTok{ncol=}\DecValTok{3}\NormalTok{, }\DataTypeTok{byrow=}\NormalTok{T)}

\CommentTok{# Calculate X and Y using built-in commands}
\NormalTok{X <-}\StringTok{ }\NormalTok{A }\OperatorTok{%*%}\StringTok{ }\KeywordTok{t}\NormalTok{(A)}
\NormalTok{Y <-}\StringTok{ }\KeywordTok{t}\NormalTok{(A) }\OperatorTok{%*%}\StringTok{ }\NormalTok{A}

\CommentTok{# Calculate eigenvalues and eigenvectors for X and Y}
\NormalTok{X.eigenvalues <-}\StringTok{ }\KeywordTok{eigen}\NormalTok{(X)}\OperatorTok{$}\NormalTok{values}
\NormalTok{X.eigenvectors <-}\StringTok{ }\KeywordTok{eigen}\NormalTok{(X)}\OperatorTok{$}\NormalTok{vectors}

\NormalTok{Y.eigenvalues <-}\StringTok{ }\KeywordTok{eigen}\NormalTok{(Y)}\OperatorTok{$}\NormalTok{values}
\NormalTok{Y.eigenvectors <-}\StringTok{ }\KeywordTok{eigen}\NormalTok{(Y)}\OperatorTok{$}\NormalTok{vectors}

\CommentTok{# Compute singular value decomposition of A}
\NormalTok{A.leftsingular <-}\StringTok{ }\KeywordTok{svd}\NormalTok{(A)}\OperatorTok{$}\NormalTok{u}
\NormalTok{A.singular <-}\StringTok{ }\KeywordTok{svd}\NormalTok{(A)}\OperatorTok{$}\NormalTok{d}
\NormalTok{A.rightsingular <-}\StringTok{ }\KeywordTok{svd}\NormalTok{(A)}\OperatorTok{$}\NormalTok{v}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Compare eigenvectors of X and Y with svd of A}
\NormalTok{X.eigenvectors}
\NormalTok{##           [,1]       [,2]}
\NormalTok{## [1,] 0.6576043 -0.7533635}
\NormalTok{## [2,] 0.7533635  0.6576043}
\NormalTok{A.leftsingular}
\NormalTok{##            [,1]       [,2]}
\NormalTok{## [1,] -0.6576043 -0.7533635}
\NormalTok{## [2,] -0.7533635  0.6576043}
\KeywordTok{is.element}\NormalTok{(A.leftsingular, X.eigenvectors)}
\NormalTok{## [1] FALSE  TRUE  TRUE  TRUE}

\NormalTok{Y.eigenvectors}
\NormalTok{##             [,1]       [,2]       [,3]}
\NormalTok{## [1,] -0.01856629 -0.6727903  0.7396003}
\NormalTok{## [2,]  0.25499937 -0.7184510 -0.6471502}
\NormalTok{## [3,]  0.96676296  0.1765824  0.1849001}
\NormalTok{A.rightsingular}
\NormalTok{##             [,1]       [,2]}
\NormalTok{## [1,]  0.01856629 -0.6727903}
\NormalTok{## [2,] -0.25499937 -0.7184510}
\NormalTok{## [3,] -0.96676296  0.1765824}
\end{Highlighting}
\end{Shaded}

From the output, we can see that the singular values of \(A\) are indeed
eigenvectors of \(X\) and \(Y\), albeit multiplied by a scalar of
\(-1\).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Compare non-zero eigenvalues of X and Y with non-zero singular values of A}
\NormalTok{X.eigenvalues}
\NormalTok{## [1] 26.601802  4.398198}
\NormalTok{Y.eigenvalues}
\NormalTok{## [1] 2.660180e+01 4.398198e+00 1.058982e-16}
\NormalTok{A.singular}\OperatorTok{^}\DecValTok{2}
\NormalTok{## [1] 26.601802  4.398198}
\end{Highlighting}
\end{Shaded}

\section{Problem Set 2}\label{problem-set-2}

\subsection{Using the procedure outlined in section 1 of the weekly
handout, write a function to compute the inverse of a well-conditioned
full-rank square matrix using
co-factors.}\label{using-the-procedure-outlined-in-section-1-of-the-weekly-handout-write-a-function-to-compute-the-inverse-of-a-well-conditioned-full-rank-square-matrix-using-co-factors.}

In order to compute the co-factors, you may use built-in commands to
compute the determinant. Your function should have the following
signature: \(B = myinverse(A)\) where \(A\) is a matrix and \(B\) is its
inverse and \(A \times B = I\). The off-diagonal elements of \(I\)
should be close to zero, if not zero. Likewise, the diagonal elements
should be close to 1, if not 1. Small numerical precision errors are
acceptable, but the function \(myinverse\) should be correct and must
use co-factors and determinant of \(A\) to compute the inverse.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{myinverse <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(A)\{}
  \CommentTok{# Check if the matrix A is square}
  \ControlFlowTok{if}\NormalTok{ (}\KeywordTok{nrow}\NormalTok{(A) }\OperatorTok{!=}\StringTok{ }\KeywordTok{ncol}\NormalTok{(A))\{}
    \KeywordTok{stop}\NormalTok{(}\StringTok{"Matrix A is not square."}\NormalTok{)}
\NormalTok{  \}}
  
\NormalTok{  dtrmnt <-}\StringTok{ }\KeywordTok{det}\NormalTok{(A)}
  \CommentTok{# Check if the matrix is of full rank}
  \ControlFlowTok{if}\NormalTok{ (dtrmnt }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{)\{}
    \KeywordTok{stop}\NormalTok{(}\StringTok{"Matrix is not full-rank"}\NormalTok{)}
\NormalTok{  \}}
  
\NormalTok{  cofactor.matrix <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DataTypeTok{nrow =} \KeywordTok{nrow}\NormalTok{(A), }\DataTypeTok{ncol =} \KeywordTok{ncol}\NormalTok{(A))}
  \ControlFlowTok{for}\NormalTok{ (row }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(A))\{}
    \ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(A))\{}
\NormalTok{      matrix.minor <-}\StringTok{ }\NormalTok{A[}\OperatorTok{-}\NormalTok{row, }\OperatorTok{-}\NormalTok{col] }\CommentTok{# Set up matrix of minors}
\NormalTok{      matrix.minor.det <-}\StringTok{ }\KeywordTok{det}\NormalTok{(matrix.minor) }\CommentTok{# Calculate its determinant}
\NormalTok{      cofactor.matrix[row, col] <-}\StringTok{ }\NormalTok{((}\OperatorTok{-}\DecValTok{1}\NormalTok{)}\OperatorTok{^}\NormalTok{(row }\OperatorTok{+}\StringTok{ }\NormalTok{col)) }\OperatorTok{*}\StringTok{ }\NormalTok{matrix.minor.det }\CommentTok{# Proper sign}
\NormalTok{    \}}
\NormalTok{  \}}
\NormalTok{  B <-}\StringTok{ }\NormalTok{(}\DecValTok{1}\OperatorTok{/}\NormalTok{dtrmnt) }\OperatorTok{*}\StringTok{ }\KeywordTok{t}\NormalTok{(cofactor.matrix)}
  \KeywordTok{return}\NormalTok{(B)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Test our function:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# 3x3 random matrix}
\NormalTok{random.mat.three <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\KeywordTok{rnorm}\NormalTok{(}\DecValTok{9}\NormalTok{),}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{)}
\CommentTok{#5x5}
\NormalTok{random.mat.five <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\KeywordTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{),}\DecValTok{5}\NormalTok{,}\DecValTok{5}\NormalTok{)}

\CommentTok{# Check if myinverse produces same result as the solve function}
\KeywordTok{all.equal}\NormalTok{(}\KeywordTok{solve}\NormalTok{(random.mat.three), }\KeywordTok{myinverse}\NormalTok{(random.mat.three))}
\NormalTok{## [1] TRUE}
\KeywordTok{all.equal}\NormalTok{(}\KeywordTok{solve}\NormalTok{(random.mat.five), }\KeywordTok{myinverse}\NormalTok{(random.mat.five))}
\NormalTok{## [1] TRUE}
\end{Highlighting}
\end{Shaded}


\end{document}
